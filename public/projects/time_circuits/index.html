<!DOCTYPE html>
<html lang="en" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="noindex, nofollow">
<title>Time circuits | Pavel Anni</title>
<meta name="keywords" content="">
<meta name="description" content="A TinyGo project implementing Time Circuits (for time travel, you know)">
<meta name="author" content="Pavel Anni">
<link rel="canonical" href="http://localhost:1313/projects/time_circuits/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.d6fcd20a4fb86efa4dfac8ec95da60244cc8871042183da1ef28e3a762ad79c8.css" integrity="sha256-1vzSCk&#43;4bvpN&#43;sjsldpgJEzIhxBCGD2h7yjjp2Ktecg=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/projects/time_circuits/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="Pavel Anni (Alt + H)">Pavel Anni</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/projects/" title="Projects">
                    <span>Projects</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/blog/" title="Blog">
                    <span>Blog</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/texts/" title="Texts">
                    <span>Texts</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/about/" title="About">
                    <span>About</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="http://localhost:1313/">Home</a>&nbsp;»&nbsp;<a href="http://localhost:1313/projects/">Projects</a></div>
    <h1 class="post-title entry-hint-parent">
      Time circuits
      <span class="entry-hint" title="Draft">
        <svg xmlns="http://www.w3.org/2000/svg" height="35" viewBox="0 -960 960 960" fill="currentColor">
          <path
            d="M160-410v-60h300v60H160Zm0-165v-60h470v60H160Zm0-165v-60h470v60H160Zm360 580v-123l221-220q9-9 20-13t22-4q12 0 23 4.5t20 13.5l37 37q9 9 13 20t4 22q0 11-4.5 22.5T862.09-380L643-160H520Zm300-263-37-37 37 37ZM580-220h38l121-122-18-19-19-18-122 121v38Zm141-141-19-18 37 37-18-19Z" />
        </svg>
      </span>
    </h1>
    <div class="post-description">
      A TinyGo project implementing Time Circuits (for time travel, you know)
    </div>
    <div class="post-meta"><span title='2024-10-07 00:00:00 +0000 UTC'>2024-10-07</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;1053 words&nbsp;·&nbsp;Pavel Anni

</div>
  </header> 
<figure class="entry-cover">
        <img loading="eager" src="http://localhost:1313/projects/time_circuits/cover.webp" alt="">
        
</figure>
  <div class="post-content"><p>You know how it all started? I was browsing Amazon one day (as you do) and came across this set of color 7-segment LED displays.</p>
<p><img alt="Seven-segment LEDs" loading="lazy" src="/projects/time_circuits/seven-segment-leds.webp"></p>
<p>Instantly, I thought of the Time Circuits display from <em>Back to the Future</em>.</p>
<p>This project combines two of my favorite things — tech tinkering and fun. I used two Raspberry Pi Picos, some 7-segment LED displays, rotary encoders, and (of course) Go! And before you ask — yes, it does something cool, and no, I haven’t hit 88 mph with it just yet.</p>
<p>This isn’t my first attempt at making this thing. I originally started with an Arduino, writing the project in C++. I even got as far as setting the destination time before life happened (probably work). It stayed unfinished for years.</p>
<p><img alt="Version 1.0" loading="lazy" src="/projects/time_circuits/version1.webp">
Time Circuits v1.0 (Arduino)</p>
<p>Version 2.0, though? That’s where things got interesting. I picked up TinyGo — a Go compiler for microcontrollers — and decided it was the perfect excuse to learn both TinyGo and Go while having fun. TinyGo works like a charm on Raspberry Pi Pico, so that became my hardware of choice.</p>
<p><img alt="Version 2.0" loading="lazy" src="/projects/time_circuits/version2.webp">
Time Curcuits v2.0 (TinyGo and Raspberry Pi Pico)</p>
<h2 id="the-hardware">The Hardware<a hidden class="anchor" aria-hidden="true" href="#the-hardware">#</a></h2>
<p>Here’s the gear I used:</p>
<ul>
<li>Two <strong>Raspberry Pi Picos</strong></li>
<li>4-digit <strong>7-segment LED</strong> displays with the TM1637 chip</li>
<li><strong>Rotary encoders</strong> for setting the time (way more satisfying than buttons)</li>
<li><strong>DFPlayer Mini</strong> to play sound effects. Because what’s a time-travel toy without some audio drama?</li>
</ul>
<p>The plan was simple: one Pico would set the “destination time,” and the other would handle the “present time” and “last time departed.” When you press a button imitating the actual time travel, the “destination time” becomes your “present time,” and the fun begins. Sounds cool, right?</p>
<h2 id="why-tinygo">Why TinyGo?<a hidden class="anchor" aria-hidden="true" href="#why-tinygo">#</a></h2>
<p>Let’s be honest: when working with microcontrollers, the usual suspects are Arduino, MicroPython, or maybe CircuitPython. But with TinyGo, I got to work in Go — one of my favorite languages. It just made everything more enjoyable (and less tedious).</p>
<p>Here’s why TinyGo rocks:</p>
<ul>
<li><strong>Goroutines</strong>: No more messing around with loops and managing every state yourself. With goroutines, the heavy lifting is done.</li>
<li><strong>Channels</strong>: These made it super easy to pass messages around without worrying about blocking the main thread. (Looking at you, Arduino.)</li>
</ul>
<h2 id="how-it-all-works">How it all works<a hidden class="anchor" aria-hidden="true" href="#how-it-all-works">#</a></h2>
<p>This setup has two brains (aka Raspberry Pi Picos) that talk to each other via UART. Here’s a rough idea of what’s going on:</p>
<ol>
<li>
<p>Left Pico: You set the “destination time” using rotary encoders and 7-segment displays.</p>
</li>
<li>
<p>Right Pico: It handles the “present time” and “last time departed” and then updates the times when you hit the button to start the journey.</p>
</li>
</ol>
<p>When you press the “time travel” button, the destination time is sent from the left Pico to the right Pico as an RFC3339 string (fancy, huh?). Then, the present time becomes the new “last time departed” — you know, just in case you want to go back to the exact moment you left.</p>
<p><img alt="Hardware diagram" loading="lazy" src="/projects/time_circuits/breadboard.webp">
Hardware connections</p>
<h2 id="software-shenanigans">Software Shenanigans<a hidden class="anchor" aria-hidden="true" href="#software-shenanigans">#</a></h2>
<p>I kept the code simple but flexible. I used goroutines to handle multiple tasks at once — like updating the display while you’re setting the time — and channels to manage button presses and other events without creating a tangled mess of code.</p>
<p>Here’s the basic rundown:</p>
<ul>
<li>You turn the rotary encoder to set the year, month, and day for the Destination time.</li>
<li>The left Pico sends that data over UART to the right Pico.</li>
<li>When you press the time-travel button, the current time is saved in the “last departed” time, and the time set as the destination becomes your present time.</li>
<li>The present time starts ticking as your typical wall clock.</li>
</ul>
<h2 id="extra-fun-stuff-sound-and-memory">Extra fun stuff: sound and memory<a hidden class="anchor" aria-hidden="true" href="#extra-fun-stuff-sound-and-memory">#</a></h2>
<p>Because time travel needs sound effects (obviously), I hooked up a DFPlayer Mini. It plays MP3s from an SD card, and the Picos send the player commands over UART.</p>
<p>Oh, and the toy remembers your settings. Every second, the times are saved to flash memory. When you power it back on, the Picos pick up right where they left off. Handy, right?</p>
<p><img alt="DFPlayer Mini" loading="lazy" src="/projects/time_circuits/dfplayer.webp">
DFPlayer Mini</p>
<h2 id="lessons-i-didnt-expect-to-learn">Lessons I didn’t expect to learn<a hidden class="anchor" aria-hidden="true" href="#lessons-i-didnt-expect-to-learn">#</a></h2>
<p>This project was a great learning experience but it wasn’t all smooth sailing. Here are some of the surprises I encountered:</p>
<ol>
<li>
<p><strong>Goroutines</strong>: In TinyGo, goroutines will keep going until they hit a blocking operation (like I/O). I had to add tiny sleep calls here and there to make everything work smoothly.</p>
</li>
<li>
<p><strong>Error handling matters</strong>: Error handling is always important, but it’s really important here. Things will go haywire if an extra character sneaks into your UART transmission. You must detect it and avoid just hanging up the whole time machine.</p>
</li>
<li>
<p><strong>Rotary encoders are not so simple</strong>: I learned about Gray code (have you heard about it?) to implement the rotary encoders, which saved me from a world of trouble. In short, it’s an alternative binary code where two consecutive numbers differ only by one bit. It turns out to be very useful in error-prone environments like electronic circuits. Read more: <a href="https://en.wikipedia.org/wiki/Gray_code">https://en.wikipedia.org/wiki/Gray_code</a>.</p>
</li>
<li>
<p><strong>Debouncing switches</strong>: That’s a whole other world of engineering. When you pressed a button, did it send just one pulse or more? If you’re going down that rabbit hole, here are some excellent reads on switch debouncing: <a href="https://www.eejournal.com/article/ultimate-guide-to-switch-debounce-part-1/">https://www.eejournal.com/article/ultimate-guide-to-switch-debounce-part-1/</a> and <a href="http://www.ganssle.com/debouncing.htm">http://www.ganssle.com/debouncing.htm</a>.</p>
</li>
</ol>
<h2 id="whats-next">What’s next?<a hidden class="anchor" aria-hidden="true" href="#whats-next">#</a></h2>
<p>There are so many ways I can build on this project. For starters, I could add a GPS and a speedometer to really nail that 88 mph speed limit and make that trigger the time-travel event instead of a lousy button. Or I could turn this into a Pomodoro timer, an alarm clock, or a chess clock — time-travel toys for all occasions.</p>
<p>Or, who knows? Maybe I’ll create a DIY kit so you can build your own time-travel toy at home.</p>
<h2 id="want-to-try-tinygo">Want to try TinyGo?<a hidden class="anchor" aria-hidden="true" href="#want-to-try-tinygo">#</a></h2>
<p>If you’re curious about TinyGo and want to dip your toes in, here’s how to start:</p>
<ol>
<li>Get a Raspberry Pi Pico Starter Kit — it usually includes sensors, motors, LEDs, and more.</li>
<li>Clone the TinyGo repo: <a href="https://github.com/tinygo-org/tinygo">https://github.com/tinygo-org/tinygo</a></li>
<li>Follow the steps here: <a href="https://tinygo.org/getting-started/">https://tinygo.org/getting-started/</a></li>
</ol>
<p>Trust me, it’s a fun way to learn Go, and you’ll get something you can actually hold and show off to your friends.</p>
<p>Please let me know if you need more details about this project. Or if you have ideas about improving it — I’ll be happy to continue working on it!</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
<nav class="paginav">
  <a class="prev" href="http://localhost:1313/projects/geekhouse/">
    <span class="title">« Prev</span>
    <br>
    <span>Geekhouse</span>
  </a>
  <a class="next" href="http://localhost:1313/projects/ssh_login_monitor/">
    <span class="title">Next »</span>
    <br>
    <span>SSH login monitor</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2024 <a href="http://localhost:1313/">Pavel Anni</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
