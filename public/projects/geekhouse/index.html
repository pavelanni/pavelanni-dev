<!DOCTYPE html>
<html lang="en" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="noindex, nofollow">
<title>Geekhouse | Pavel Anni</title>
<meta name="keywords" content="">
<meta name="description" content="How a toy project helped me to learn more about IoT, REST API and large language models (LLM)">
<meta name="author" content="Pavel Anni">
<link rel="canonical" href="http://localhost:1313/projects/geekhouse/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.d6fcd20a4fb86efa4dfac8ec95da60244cc8871042183da1ef28e3a762ad79c8.css" integrity="sha256-1vzSCk&#43;4bvpN&#43;sjsldpgJEzIhxBCGD2h7yjjp2Ktecg=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/projects/geekhouse/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="Pavel Anni (Alt + H)">Pavel Anni</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/projects/" title="Projects">
                    <span>Projects</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/blog/" title="Blog">
                    <span>Blog</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/texts/" title="Texts">
                    <span>Texts</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/about/" title="About">
                    <span>About</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="http://localhost:1313/">Home</a>&nbsp;»&nbsp;<a href="http://localhost:1313/projects/">Projects</a></div>
    <h1 class="post-title entry-hint-parent">
      Geekhouse
      <span class="entry-hint" title="Draft">
        <svg xmlns="http://www.w3.org/2000/svg" height="35" viewBox="0 -960 960 960" fill="currentColor">
          <path
            d="M160-410v-60h300v60H160Zm0-165v-60h470v60H160Zm0-165v-60h470v60H160Zm360 580v-123l221-220q9-9 20-13t22-4q12 0 23 4.5t20 13.5l37 37q9 9 13 20t4 22q0 11-4.5 22.5T862.09-380L643-160H520Zm300-263-37-37 37 37ZM580-220h38l121-122-18-19-19-18-122 121v38Zm141-141-19-18 37 37-18-19Z" />
        </svg>
      </span>
    </h1>
    <div class="post-description">
      How a toy project helped me to learn more about IoT, REST API and large language models (LLM)
    </div>
    <div class="post-meta"><span title='2024-12-23 19:44:07 -0500 EST'>2024-12-23</span>&nbsp;·&nbsp;9 min&nbsp;·&nbsp;1846 words&nbsp;·&nbsp;Pavel Anni

</div>
  </header> 
<figure class="entry-cover">
        <img loading="eager" src="http://localhost:1313/projects/geekhouse/keyestudio_house_esp32.png" alt="">
        
</figure>
  <div class="post-content"><h2 id="previously">Previously<a hidden class="anchor" aria-hidden="true" href="#previously">#</a></h2>
<p>It all started several years ago when I thought &ldquo;Can I use Alexa to manage physical devices?&rdquo;
I created a simple demo project to show it to my amateur radio friends.
You would say, &ldquo;Alexa, turn my antenna 90 degrees,&rdquo; and my model antenna would magically turn.
It was a fun weekend project that used a Raspberry Pi, a stepper motor, and a miniature model antenna.
I published it on YouTube, if you&rsquo;re curious.</p>
<p><img alt="Alexa Antenna application" loading="lazy" src="/projects/geekhouse/alexa_antenna.png"></p>
<h2 id="smart-dollhouse">Smart dollhouse<a hidden class="anchor" aria-hidden="true" href="#smart-dollhouse">#</a></h2>
<p>The Alexa experiment was great but had some issues.
With Alexa, you should be very precise with your phrases.
In my application, Alexa expected you to say, &ldquo;Alexa, turn my antenna XX degrees,&rdquo; and only this exact phrase would work.
With the growing availability of large language models (LLM) I started thinking about using them to manage motors, devices, and sensors.</p>
<p>&ldquo;What if I get a dollhouse,&rdquo; I thought, &ldquo;and add a bunch of sensors and a microcontroller and write a REST API server for them?&rdquo;
Then, I&rsquo;ll ask an LLM to convert human language to REST API requests and send them to the server.
Also, I wanted something that looks realistic and not just a bunch of sensors scattered on my desk.</p>
<p>Luckily, I found <em>exactly</em> what I needed on Amazon: a wooden house with many of sensors attached to it and a microcontroller.
I have to praise the great quality of the kit I bought from Keyestudio: it was very easy to build and attach the sensors, and the
software worked on the first run!
If you tried similar kits before, you should know it&rsquo;s not very common.</p>
<p><img alt="Keyestudio house" loading="lazy" src="/projects/geekhouse/keyestudio_house_esp32.png"></p>
<p>The kit included a simple Arduino controller with a sample program that implemented some business logic: for example,
when there was a signal on the rain sensor on the roof, the servo motor would close the window.</p>
<p>It worked fine, but I needed a server to respond to remote requests.</p>
<h2 id="iot-server">IoT server<a hidden class="anchor" aria-hidden="true" href="#iot-server">#</a></h2>
<p>I decided to switch to Raspberry Pi Pico W and MicroPython.
The &ldquo;W&rdquo; version of Pico gave me the connectivity I needed, and I was going to use MicroPython to implement a simple REST API server.</p>
<h3 id="using-ai-helpers">Using AI helpers<a hidden class="anchor" aria-hidden="true" href="#using-ai-helpers">#</a></h3>
<p>As it&rsquo;s becoming more common these days, I asked Claude.ai to help me with this project.</p>
<blockquote>
<p>I want to write a program in MicroPython for Raspberry Pi Pico. It should run a web server connected to WiFi.
The web server should accept REST requests and perform actions on the Pico, such as: getting information from sensors, turning LEDs on and off, turning motors (servos and steppers) on and off.
Please help me create an API for this application.</p>
</blockquote>
<p>Claude answered with a list of <code>curl</code> commands that can be used against our planned API.
I liked this approach: you design the expected user experience first (in our case, it was REST API) and then start implementing it.</p>
<p>It created a very simple web server without using any frameworks at all, just with sockets.
I asked if we can use a framework like Flask, and Claude told me that with MicroPython it&rsquo;s more common to use Microdot
because it is lighter on resources.
I learned that Microdot is being developed by Miguel Grinberg, the author of one of the most popular books about Flask.
That was a good recommendation and I asked Claude to re-write the web server with Microdot.</p>
<p>After that was done, I tested the server on my Pico and it worked just fine!
But I had a further idea, and I asked:</p>
<blockquote>
<p>Please help me write the GET function for Microdot that will return a list of sensors when called as <code>/sensors</code> and the sensor&rsquo;s value when called with /sensors/id.
I think this should help with discoverability.</p>
</blockquote>
<p>And here was another discovery!
Claude told me about the concept with a strange name &ldquo;HATEOAS,&rdquo; which stands for Hypermedia as the Engine of Application State.
It explained the idea behind it, gave examples, and finally, wrote the server code that would respond to routes like <code>/sensors</code> or <code>/leds</code> with
the information about sensors and LEDs locations (roof, garden, door), parameters (LED&rsquo;s color, sensor&rsquo;s calibration),
and, most importantly, the links I should use to work with them.</p>
<p>That was very close to what I needed.</p>
<h2 id="using-llm-to-generate-rest-api-calls">Using LLM to generate REST API calls<a hidden class="anchor" aria-hidden="true" href="#using-llm-to-generate-rest-api-calls">#</a></h2>
<p>Now, thanks to Claude&rsquo;s help, I had a server that would respond to requests like <code>curl http://server/leds</code> with the following JSON:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;_links&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;filter_by_color&#34;</span>: {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;href&#34;</span>: <span style="color:#e6db74">&#34;/leds/filter?color={color}&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;templated&#34;</span>: <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;self&#34;</span>: {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;href&#34;</span>: <span style="color:#e6db74">&#34;/leds&#34;</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;filter_by_location&#34;</span>: {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;href&#34;</span>: <span style="color:#e6db74">&#34;/leds/filter?location={location}&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;templated&#34;</span>: <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;data&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;1&#34;</span>: {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;color&#34;</span>: <span style="color:#e6db74">&#34;yellow&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;location&#34;</span>: <span style="color:#e6db74">&#34;roof&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;state&#34;</span>: <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;_links&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;on&#34;</span>: {
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&#34;href&#34;</span>: <span style="color:#e6db74">&#34;/leds/1/on&#34;</span>
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;self&#34;</span>: {
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&#34;href&#34;</span>: <span style="color:#e6db74">&#34;/leds/1&#34;</span>
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;off&#34;</span>: {
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&#34;href&#34;</span>: <span style="color:#e6db74">&#34;/leds/1/off&#34;</span>
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;toggle&#34;</span>: {
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&#34;href&#34;</span>: <span style="color:#e6db74">&#34;/leds/1/toggle&#34;</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;2&#34;</span>: {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;color&#34;</span>: <span style="color:#e6db74">&#34;white&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;location&#34;</span>: <span style="color:#e6db74">&#34;garden&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;state&#34;</span>: <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;_links&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;on&#34;</span>: {
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&#34;href&#34;</span>: <span style="color:#e6db74">&#34;/leds/2/on&#34;</span>
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;self&#34;</span>: {
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&#34;href&#34;</span>: <span style="color:#e6db74">&#34;/leds/2&#34;</span>
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;off&#34;</span>: {
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&#34;href&#34;</span>: <span style="color:#e6db74">&#34;/leds/2/off&#34;</span>
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;toggle&#34;</span>: {
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&#34;href&#34;</span>: <span style="color:#e6db74">&#34;/leds/2/toggle&#34;</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>What if I get similar JSONs from the other routes, such as <code>/sensors</code> and <code>/motors</code>, send them to an LLM, and ask it to convert human requests to <code>curl</code> commands?
Then, I can send those commands to the server via the <code>requests</code> Python library and work with the devices!</p>
<p>The next step was to write a simple Python script that would get the initial links from the root (<code>/</code>) route of the server and explore all links to get the same JSONs from them.</p>
<p>After the script collected the API description of the server this way, I created a system prompt that included the whole JSON with all the links from the server and added the request:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>You are an IoT API assistant.
</span></span><span style="display:flex;"><span>Convert user commands to curl commands for the IoT server.
</span></span><span style="display:flex;"><span>API structure: {json.dumps(self.api_structure, indent=2)}
</span></span><span style="display:flex;"><span>Server URL: {self.server_url}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Respond only with the curl command, no explanations.
</span></span></code></pre></div><p>Then I created a simple dialog that would get the command from the user in human language, attach it to the prompt, and send it to the LLM.</p>
<p>For this application, I used Haiku-3.5 from Anthropic because it is faster and cheaper than more complex models.</p>
<h2 id="translate-json-responses-to-human-language">Translate JSON responses to human language<a hidden class="anchor" aria-hidden="true" href="#translate-json-responses-to-human-language">#</a></h2>
<p>Now the system has started working.
I would send a message like, &ldquo;Turn the yellow LED on,&rdquo; and it turned on.
Or, &ldquo;Turn the garden LED on,&rdquo; and the white LED in the garden would turn on.
I could ask in normal language, &ldquo;What&rsquo;s the light conditions on the roof?&rdquo; and it responded with a JSON that included a lot of information:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;_links&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;config&#34;</span>: {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;href&#34;</span>: <span style="color:#e6db74">&#34;/sensors/2/config&#34;</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;self&#34;</span>: {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;href&#34;</span>: <span style="color:#e6db74">&#34;/sensors/2/value&#34;</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;all_sensors&#34;</span>: {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;href&#34;</span>: <span style="color:#e6db74">&#34;/sensors&#34;</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;sensor&#34;</span>: {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;href&#34;</span>: <span style="color:#e6db74">&#34;/sensors/2&#34;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;data&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;unit&#34;</span>: <span style="color:#e6db74">&#34;lux&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;light&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;calibrated_value&#34;</span>: <span style="color:#ae81ff">4114.6</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;location&#34;</span>: <span style="color:#e6db74">&#34;roof&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;id&#34;</span>: <span style="color:#e6db74">&#34;2&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;raw_value&#34;</span>: <span style="color:#ae81ff">41146</span>
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>That was good, but I wanted more reasonable human language instead of JSON!
LLM was to the rescue again!
Here is another prompt for Haiku:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Convert this IoT API JSON response to concise human language, focusing on the most important information.
</span></span><span style="display:flex;"><span>Don&#39;t print &#39;Here is the concise summary&#39; or other explanations; print just the content:
</span></span></code></pre></div><p>And now the answers from my server looked like:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Light sensor #2 located on the roof is measuring 4,109.8 lux, indicating bright illumination conditions.
</span></span></code></pre></div><h2 id="first-public-demo">First public demo<a hidden class="anchor" aria-hidden="true" href="#first-public-demo">#</a></h2>
<p>Recently, I went to the local Python meetup in Atlanta.
I was going to give a presentation about this project and demonstrate it.
Needless to say, I was nervous.</p>
<p>I started a hotspot on my cell phone, connected my laptop to it, and started the Pico.
It indicated that it had connected to the hotspot and got an IP address.
Now I had to change my dialogue program to point to that address.</p>
<p>The dialogue began:</p>
<pre tabindex="0"><code class="language-none" data-lang="none">IoT Controller started. Type &#39;quit&#39; to exit.

&gt;&gt;&gt; turn the yellow led on

LED 1 is currently on, colored yellow, and located on the roof.

&gt;&gt;&gt; turn the motor on

Motor 1 (DC type) is currently ON and located on the roof.

&gt;&gt;&gt; turn the motor off

Motor #1, a DC motor located on the roof, is currently turned off.
</code></pre><p>So far, so good.
The public loved it when the propeller started spinning and gave me a round of applause.</p>
<p>I switched my keyboard to Cyrillic and typed this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>&gt;&gt;&gt; выключи желтый led
</span></span></code></pre></div><p>&ldquo;Wow, is it Russian?&rdquo; I heard the murmur in the audience.</p>
<p>And magic happened. The LED went off, and I got this message:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>LED 1 located on the roof is yellow and currently off (state 0).
</span></span></code></pre></div><p>I asked the meetup organizer, &ldquo;Pablo, can you tell it in Spanish to turn the LED on?&rdquo;</p>
<p>Pablo took the keyboard and typed:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>&gt;&gt;&gt; Por favor prender el LED amarillo
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>LED 1 is currently on (state 1), colored yellow, and located on the roof.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&gt;&gt;&gt; Apaga la maldita led amarilla
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>LED 1 is currently off, located on the roof, and colored yellow.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&gt;&gt;&gt;
</span></span></code></pre></div><p>&ldquo;Wow!&rdquo; said the audience.</p>
<p>I explained, &ldquo;This magic is done purely by the LLM. I didn&rsquo;t do anything in the code.
It understands many languages and translates between them and REST and JSON easily.
Note that when I spoke to it in Russian, I used the English word &lsquo;LED&rsquo;, and it understood me perfectly.&rdquo;</p>
<h2 id="lessons-learned">Lessons Learned<a hidden class="anchor" aria-hidden="true" href="#lessons-learned">#</a></h2>
<p>This project turned out to be an unexpected learning journey.
I started with a simple idea of controlling a dollhouse but ended up learning:</p>
<ul>
<li>MicroPython and its differences from regular Python</li>
<li>Microdot - a lightweight web framework perfect for microcontrollers</li>
<li>HATEOAS - a REST API design principle with a name that sounds like a sneeze</li>
<li>The incredible versatility of LLMs in handling natural language processing</li>
</ul>
<p>Most importantly, I learned that AI assistants like Claude can be excellent coding partners.
They not only help with code but also introduce you to best practices and concepts you might not have discovered otherwise.</p>
<h2 id="future-plans">Future plans<a hidden class="anchor" aria-hidden="true" href="#future-plans">#</a></h2>
<p>Of course, I started looking for ways to expand the project.
And, of course, I found this: a huge 42-in-1 kit from Keyestudio with a lot of sensors and actuators.</p>
<p>Wouldn&rsquo;t it be cool to say something and have it displayed on the LCD screen?
Gas sensors, accelerometers, buzzers, and motors are waiting for me to connect them.</p>
<h2 id="getting-more-serious">Getting more serious<a hidden class="anchor" aria-hidden="true" href="#getting-more-serious">#</a></h2>
<p>Of course, it&rsquo;s just a toy project created for learning.
If you want to use IoT in your real home, of course, you should take a look at <a href="https://www.home-assistant.io/">Home Assistant</a>.
That&rsquo;s what I did, thinking, &ldquo;Can I apply the same approach to creating Home Assistant&rsquo;s API requests?&rdquo;
Needless to say, the project has already implemented the <a href="https://developers.home-assistant.io/docs/core/llm/">API for LLMs</a>
&ldquo;Great minds think alike,&rdquo; I said to myself proudly. 😉</p>
<h2 id="project-code">Project code<a hidden class="anchor" aria-hidden="true" href="#project-code">#</a></h2>
<p>If you&rsquo;re interested in building your own multilingual smart dollhouse (or just want to see how it all works), check out the project on GitHub: <a href="https://github.com/pavelanni/geekhouse">Geekhouse Repository</a>. Feel free to contribute, ask questions, or share your own IoT adventures.</p>
<p>Try to use any language you know and see if the LLM can translate it into REST API calls!
Try other LLMs, try a local LLM running in your homelab.
Most likely, using a local LLM will make turning LEDs on and off faster.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
<nav class="paginav">
  <a class="next" href="http://localhost:1313/projects/time_circuits/">
    <span class="title">Next »</span>
    <br>
    <span>Time circuits</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2024 <a href="http://localhost:1313/">Pavel Anni</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
